<html>
  <head>
      <script
  src="https://code.jquery.com/jquery-3.5.1.min.js"
  integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0="
  crossorigin="anonymous"></script>
  </head>
  <style>
    .total_container {
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    
    .form_container {
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    .input_container {
      display: flex;
      flex-direction: column;
    }

    .input_container > input {
      margin-bottom: 10px;
      height: 50px;
      width: 400px;
      padding: 10px;
    }

  </style>

  <body>
    <div class="total_container" style="margin-top: 10px;">
      <div style="margin-top: 30px;">
        <img
          src="../images/123.jpg"
          width="200px"
          height="200px"
        />
      </div>
      <h1><%= gameName %></h1>
      <div class="form_container">
        <form id="login_form" class="form" action="/signup" method="post">
          <div class="input_container">  
            <input name="name" placeholder="아이디"/>
            <input name="password" placeholder="비밀번호"/>
            <input type="submit" value="로그인"/>
          </div>
        </form>
      </div>

      <div class="form_container">
        <h3 style="margin-top: 50px;">아직 아이디가 없으신가요?</h3>
          <form id="register_form" class="form" action="/register">
            <div class="input_container">  
              <input name="name" placeholder="아이디"/>
              <input name="password" placeholder="비밀번호"/>
              <input name="re_password" placeholder="비밀번호 확인"/>
              <input type="submit" value="회원가입"/>
            </div>
          </form>
      </div>

    </div>
    

    <script>

    const key = localStorage.getItem('_key');
    if (key) {
      location.href = '/game';
    }
     $('#form').submit(function(e) {
       e.preventDefault();
       const action = $(this).attr('action');
       $.post(action, $(this).serialize(),(res) => {
         if(res.key) {
          localStorage.setItem('_key', res.key);
          location.href = '/game';
         }
         else {
          alert("에러가 발생했습니다. 다시 시도해주세요.");
         }
       });
     });
    </script>
  </body>
</html>
